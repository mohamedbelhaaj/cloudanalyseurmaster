<div class="main-container">
  <div class="card">
    <div class="card-content">
      <h3>Créer une Action de Mitigation</h3>
      <p style="color: var(--text-secondary); margin-bottom: 2rem;">
        Vous créez une action pour le rapport : <strong>{{ reportId }}</strong>
      </p>
      <form [formGroup]="mitigationForm" (ngSubmit)="submit()">
        <div class="form-group">
          <label class="form-label">Type d'action</label>
          <select class="form-control" formControlName="action_type">
            <option *ngFor="let opt of actionOptions" [value]="opt.value">{{ opt.label }}</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Cible (IP, Domaine, ...)</label>
          <input class="form-control" formControlName="target_value" type="text" placeholder="IP, domaine, etc.">
        </div>
        <div class="form-group">
          <label class="form-label">Région AWS</label>
          <select class="form-control" formControlName="aws_region">
            <option *ngFor="let reg of awsRegions" [value]="reg">{{ reg }}</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Description / Note</label>
          <textarea class="form-control" formControlName="description" rows="3"></textarea>
        </div>
        <div class="form-group" style="display: flex; align-items: center;">
          <input type="checkbox" formControlName="execute_now" id="execute_now" class="form-check-input">
          <label for="execute_now" class="form-check-label" style="margin-left:8px;">
            Exécuter immédiatement sur AWS
          </label>
        </div>
        <button type="submit" class="btn" [disabled]="loading">Créer et Exécuter</button>
      </form>
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
      <div *ngIf="mitigationResult" class="result-card" style="margin-top:15px;">
        <h4>Mitigation créée</h4>
        <p><strong>Type : </strong>{{ mitigationResult.action_type }}</p>
        <p><strong>Cible : </strong>{{ mitigationResult.target_value }}</p>
        <p><strong>État : </strong>{{ mitigationResult.status }}</p>
        <p><strong>Région AWS : </strong>{{ mitigationResult.aws_region }}</p>
        <p><strong>Description : </strong>{{ mitigationResult.description }}</p>
        <p *ngIf="mitigationResult.error_message"><strong>Erreur : </strong>{{ mitigationResult.error_message }}</p>
      </div>
    </div>
  </div>
</div>
